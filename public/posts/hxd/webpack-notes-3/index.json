[{"content":"æœ¬æ–‡å¯¹äºwebpack ç¼–è¯‘å‡ºçš„å†…å®¹åšåˆ†ææ€»ç»“ã€‚\næ™®é€šæ–‡ä»¶å¼•å…¥çš„æ‰“åŒ… 1 2  // src/test.js module.exports = \u0026#39;test\u0026#39;   1 2 3  // src/index.js let test = require(\u0026#39;./test\u0026#39;); console.log(test)   æ‰“åŒ…åçš„main.js(æ‘˜å–éƒ¨åˆ†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  // æ‰“åŒ…å…¥å£ ./src/index.js (function (modules) { var installedModules = {}; function __webpack_require__(moduleId) { // ç¼“å­˜ä½œç”¨ï¼Œå¦‚æœå·²ç»å¼•å…¥è¿‡äº†ï¼Œä½¿ç”¨å¼•å…¥è¿‡çš„ç»“æœ  if (installedModules[moduleId]) { return installedModules[moduleId].exports; } var module = installedModules[moduleId] = { i: moduleId, l: false, exports: {} }; modules[moduleId].call(module.exports, module, module.exports, __webpack_require__); module.l = true; return module.exports; } return __webpack_require__(__webpack_require__.s = \u0026#34;./src/index.js\u0026#34;); }) ({ // åŒ…è£…æˆä¸€ä¸ªæ¨¡å—å¯¹è±¡ ç»å¯¹è·¯å¾„å¯¹åº”è¿™ä¸ªæ¨¡å—  \u0026#34;./src/index.js\u0026#34;: (function (module, exports, __webpack_require__) { // å°†ä»£ç ä¸­çš„require -\u0026gt;__webpack_require__ t console.log(test) }), \u0026#34;./src/test.js\u0026#34;: (function (module, exports) { module.exports = \u0026#39;test\u0026#39; }) });   åœ¨æˆ‘ç†è§£çœ‹æ¥ï¼Œåœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ¨¡å—è¢«å°è£…æˆäº†ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤æ—¶æ¨¡å—ä»£ç å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ”¾åœ¨äº†æ‰“åŒ…æ–‡ä»¶è‡ªæ‰§è¡Œå‡½æ•°çš„å‚æ•°modules ä¸­ï¼Œä»è¿™ä¸ªè‡ªæ‰§è¡Œå‡½æ•°çš„æœ«å°¾\n1  return __webpack_require__(__webpack_require__.s = \u0026#34;./src/index.js\u0026#34;);   å¼€å§‹ï¼Œæ ¹æ®å…¥å£æ–‡ä»¶å¼•ç”¨çš„æ–‡ä»¶é€ä¸€è¿è¡Œï¼ŒåŸæ–‡ä»¶ä¸­çš„require è¢«æ›¿ä»£æˆ__webpack_require__ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œwebpackæ‰“åŒ…çš„æ–‡ä»¶éƒ½æ²¡æœ‰ä½¿ç”¨node/es6çš„å¼•ç”¨æ–¹æ³•ï¼Œè€Œæ˜¯è‡ªå·±å®ç°çš„__webpack_require__æ–¹æ³•ã€‚\nä»__webpack_require__('./src/index.js\u0026rsquo;)å¼€å§‹ï¼Œæ‹¿åˆ°å‚æ•°modulesä¸­è¢«åŒ…è£…çš„index.js çš„å†…å®¹ï¼Œé‡åˆ°__webpack_require__('./src/test.js\u0026rsquo;) æ—¶ï¼Œè¿è¡Œå‚æ•°modulesä¸­./src/test.js å¯¹åº”çš„å°è£…æ–¹æ³•ï¼Œæ¯è¿è¡Œå®Œä¸€ä¸ªæ¨¡å—ï¼Œå°±ä¼šä¸ºå…¶ç”Ÿæˆä¸€ä¸ªmoduleå¯¹è±¡æ·»åŠ åˆ°installedModulesï¼Œ{ i: moduleId, l: false, exports:{}},ä¿å­˜å…¶è·¯å¾„iï¼Œå¯¼å‡ºçš„å†…å®¹exportsï¼Œæ ‡è®°æ˜¯å¦å·²ç»åŠ è½½è¿‡l,installedModules å¯ä»¥èµ·åˆ°ç¼“å­˜çš„ä½œç”¨ï¼Œå¦‚æœå·²ç»åŠ è½½è¿‡çš„æ¨¡å—å¯ä»¥ç›´æ¥ä»installedModulesé‡Œæ‹¿åˆ°ã€‚\nä¸åŒå¼•å…¥æ–¹æ³•çš„æ‰“åŒ… ä¼—æ‰€å‘¨çŸ¥ï¼Œç›®å‰æ¯”è¾ƒæµè¡Œçš„æ¨¡å—åŠ è½½æ–¹å¼æ˜¯nodejsçš„module.exports/require ä»¥åŠes6çš„ import/export,åœ¨webpackä¸­è¿™ä¸¤ç§æ‰“åŒ…æ–¹å¼éƒ½æ”¯æŒï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­çš„__webpack_require__ ä¸¤ç§éƒ½æ”¯æŒï¼Œå°è¯•é€šè¿‡es6 å°†ä¸Šä¾‹ä¸­çš„test.js ä¿®æ”¹æˆ\n1 2  // src/test.js export const test = \u0026#39;test\u0026#39;   æ‰“åŒ…åçš„main.js(æ‘˜å–éƒ¨åˆ†)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  (function(modules) { // webpackBootstrap  // The module cache  var installedModules = {}; // The require function  function __webpack_require__(moduleId) { if(installedModules[moduleId]) { return installedModules[moduleId].exports; } var module = installedModules[moduleId] = { i: moduleId, l: false, exports: {} }; modules[moduleId].call(module.exports, module, module.exports, __webpack_require__); module.l = true; return module.exports; } __webpack_require__.m = modules; __webpack_require__.c = installedModules; __webpack_require__.d = function(exports, name, getter) { if(!__webpack_require__.o(exports, name)) { Object.defineProperty(exports, name, { enumerable: true, get: getter }); } }; __webpack_require__.r = function(exports) { if(typeof Symbol !== \u0026#39;undefined\u0026#39; \u0026amp;\u0026amp; Symbol.toStringTag) { Object.defineProperty(exports, Symbol.toStringTag, { value: \u0026#39;Module\u0026#39; }); } Object.defineProperty(exports, \u0026#39;__esModule\u0026#39;, { value: true }); }; __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); }; return __webpack_require__(__webpack_require__.s = \u0026#34;./src/index.js\u0026#34;); }) ({ \u0026#34;./src/index.js\u0026#34;: (function(module, exports, __webpack_require__) { let test = __webpack_require__(\u0026#34;./src/test.js\u0026#34;); console.log(test) }), \u0026#34;./src/test.js\u0026#34;: (function(module, __webpack_exports__, __webpack_require__) { __webpack_require__.r(__webpack_exports__); __webpack_require__.d(__webpack_exports__, \u0026#34;test\u0026#34;, function() { return test; }); const test = \u0026#39;test\u0026#39; }) });   å¯ä»¥çœ‹å‡ºï¼Œä¸ä¸Šä¾‹ä¸­æœ€å¤§çš„åŒºåˆ«æ˜¯åŒ…è£…test.js å‘ç”Ÿäº†å˜åŒ–ï¼Œå»é™¤äº†export å…³é”®å­—ï¼Œå¹¶ä¸”æ·»åŠ äº†\n__webpack_require__.r(__webpack_exports__); __webpack_require__.d(__webpack_exports__, \u0026quot;test\u0026quot;, function() { return test; }); æŸ¥çœ‹__webpack_require__.ræ–¹æ³•ï¼Œå‘ç°æ˜¯å‘æ¨¡å—è¿è¡Œç»“æœexportsä¸­æ·»åŠ æ ‡è®°ï¼Œæ ‡è®°å½“å‰æ¨¡å—__esModule ä¸ºtrue,å¦‚æœæ˜¯æ”¯æŒ\nSymbolçš„æµè§ˆå™¨ï¼Œä¹Ÿæ·»åŠ ä¸€ä¸ªSymbolå€¼ä¸ºModuleï¼Œè¿™ç§æ ‡è®°æ˜¯ä¸ºäº†åç»­æœ‰éœ€è¦çš„åœ°æ–¹å¯ä»¥è¯†åˆ«æ­¤æ¨¡å—çš„å¯¼å‡ºæ–¹å¼ï¼Œ__webpack_require__.d æ–¹æ³•åˆ™æ˜¯ä¸ºå½“å‰å¯¼å‡ºçš„exports å¯¹è±¡ä¸Šæ·»åŠ ä¸€ä¸ªå€¼ä¸º\u0026rsquo;test\u0026rsquo;çš„test å±æ€§ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œtest.js ä¹Ÿæœ‰äº†module.exports = {test: \u0026lsquo;test\u0026rsquo;}çš„æ•ˆæœã€‚\nåŒç†ï¼Œå…¶ä»–å¯¼å‡º/å¯¼å…¥ç»„åˆï¼Œwebpack éƒ½ä¼šå¯¹åŒ…è£…å‡½æ•°åšä¸åŒçš„å¤„ç†ï¼Œä»¥ä¾¿èƒ½ç»Ÿä¸€è¾¾åˆ°æ•ˆæœã€‚\n","description":"","id":2,"section":"posts","tags":["å‰ç«¯","webpack"],"title":"webpack å­¦ä¹ æ€»ç»“ ä¸‰","uri":"https://blog.syzh.fun/posts/hxd/webpack-notes-3/"},{"content":"ä¸Šä¸€ç¯‡æ€»ç»“äº†webpackä¸­ä½¿ç”¨çš„ä¸€äº›åº“ï¼Œè¿™ä¸€ç¯‡æ¥æ€»ç»“ä¸‹webpackæ•´ä½“æµç¨‹,ä¸»è¦æ ¹æ®ä»£ç æµç¨‹æ¥æ€»ç»“ã€‚\n","description":"","id":3,"section":"posts","tags":["å‰ç«¯","webpack"],"title":"webpack å­¦ä¹ æ€»ç»“ äºŒ","uri":"https://blog.syzh.fun/posts/hxd/webpack-notes-2/"},{"content":"webpack æ˜¯å½“å‰å‰ç«¯é¡¹ç›®æ‰“åŒ…å½“ä¸­éå¸¸æµè¡Œçš„æ‰“åŒ…æ¡†æ¶ï¼Œç»“åˆä¸°å¯Œçš„æµç¨‹é’©å­å‡½æ•°ã€æ’ä»¶ç³»ç»Ÿä»¥åŠnodejséƒ¨åˆ†åŠŸèƒ½ ç»™å¼€å‘è€…æä¾›äº†æ–¹ä¾¿é…ç½®ï¼Œæ˜“äºæ‰©å±•çš„æ‰“åŒ…å·¥å…·ï¼Œåœ¨å­¦ä¹ webpackæºç æµç¨‹(4.43.0)çš„è¿™æ®µæ—¶é—´æ”¶è·å¾ˆå¤šï¼Œåœ¨æ­¤åšä¸€äº›æ€»ç»“ã€‚\næœ¬æ–‡é¦–å…ˆæ€»ç»“ä¸‹ï¼Œåœ¨webpackä¸­ç”¨åˆ°çš„è¯¸å¤šå·¥å…·é¡¹ç›®ï¼Œä»–ä»¬åœ¨å®ç°æ•´ä½“æµç¨‹ä¸­èµ·åˆ°äº†å¾ˆå¤§çš„ä½œç”¨ã€‚\nä¸€ Tapable Tapableæ˜¯webpackæµç¨‹çš„åŸºç¡€ï¼Œæ•´ä¸ªç¼–è¯‘è¿‡ç¨‹ï¼Œå„ä¸ªæ¨¡å—çš„æ–¹æ³•è°ƒç”¨éƒ½æ˜¯åŸºäºTapableçš„äº‹ä»¶æ³¨å†Œå’Œè§¦å‘ã€‚ç›¸å¯¹äºnodejs çš„EventEmitterï¼ŒTapableæä¾›äº†äº‹ä»¶è§¦å‘çš„æ›´å¤šå½¢å¼ï¼ŒåŒæ­¥è§¦å‘ï¼Œå¼‚æ­¥å¹¶è¡Œè§¦å‘ï¼Œå¼‚æ­¥ä¸²è¡Œè§¦å‘ç­‰ç­‰ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒéœ€æ±‚ã€‚\nåœ¨webapckä¸­ï¼Œæœ€ä¸»è¦çš„Compilerå’ŒCompilationç±»éƒ½ç»§æ‰¿äº†\nTapableï¼Œä»è€Œå¯ä»¥ç”Ÿæˆè‡ªå·±çš„ä¸€ç³»åˆ—é’©å­å‡½æ•°ï¼Œè¿™äº›é’©å­å‡½æ•°åœ¨æµç¨‹æ§åˆ¶ä¸­èµ·åˆ°æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼Œä¹Ÿä¸ºå¼€å‘è€…è‡ªå®šä¹‰åŠŸèƒ½æä¾›äº†çµæ´»çš„æ¥å£ã€‚\nå®˜ç½‘ä¸­çš„ä¾‹å­ï¼š\nconst { SyncHook, AsyncParallelHook, } = require(\u0026quot;tapable\u0026quot;); class Car { constructor() { this.hooks = { accelerate: new SyncHook([\u0026quot;newSpeed\u0026quot;]), brake: new SyncHook(), calculateRoutes: new AsyncParallelHook([\u0026quot;source\u0026quot;, \u0026quot;target\u0026quot;, \u0026quot;routesList\u0026quot;]) }; } /* ... */ } const myCar = new Car(); // ç›¸å½“äºç»™brakeé’©å­æ·»åŠ ä¸€ä¸ªäº‹ä»¶ï¼ˆæ­¤æ—¶å¹¶ä¸ä¼šæ‰§è¡Œï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªï¼‰ myCar.hooks.brake.tap(\u0026quot;WarningLampPlugin\u0026quot;, () =\u0026gt; warningLamp.on()); // è§¦å‘é’©å­å‡½æ•°,å¯ä»¥åœ¨éœ€è¦çš„æ—¶æœºæ¥è§¦å‘ï¼Œwebpackä¸­æ­£æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹æ¥ç»Ÿä¸€ç»™å„æµç¨‹æ·»åŠ é€»è¾‘ myCar.hooks.brake.call() äºŒ neo-async neo-async å…¶ä¸­çš„forEach æ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„è¿›è¡Œå¼‚æ­¥å¾ªç¯ï¼Œå¾ªç¯ç»“æŸåæ‰§è¡Œå›è°ƒ,åœ¨webpackä¸­å¤„ç†æ¨¡å—ä¾èµ–æ—¶éœ€è¦ç”¨åˆ°è¯¥æ–¹æ³•æ¥ç¡®ä¿åœ¨æ¨¡å—çš„æ‰€æœ‰ä¾èµ–å¤„ç†å®Œæˆä¹‹åè¿›è¡Œä¸‹ä¸€æ­¥ã€‚\n// array var order = []; var array = [1, 3, 2]; var iterator = function(num, done) { setTimeout(function() { order.push(num); done(); }, num * 10); }; async.each(array, iterator, function(err, res) { console.log(res); // undefined console.log(order); // [1, 2, 3] }); ä¸‰ Semaphore Semaphore\næ˜¯ä¸€ä¸ªæ§åˆ¶å¹¶å‘æ•°é‡çš„å·¥å…·ï¼Œå¯ä»¥è®¾ç½®æœ€å¤§å¹¶å‘é‡ï¼Œåœ¨ä»»åŠ¡ç»“æŸæ—¶é‡Šæ”¾å®¹é‡ï¼Œæ¯æ¬¡take ä¸€ä¸ªä»»åŠ¡æ—¶éƒ½ä¼šæŸ¥çœ‹æ˜¯å¦åˆ°è¾¾å®¹é‡æé™ï¼Œå¦‚æœåˆ°è¾¾ä¼šå­˜å‚¨ä»»åŠ¡åˆ°é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…å®¹é‡è¢«é‡Šæ”¾æ—¶å†ä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œ\n// 2 clients at a time var sem = require('semaphore')(2); var server = require('http').createServer(req, res) { res.write(\u0026quot;Then good day, madam!\u0026quot;); sem.take(function() { res.end(\u0026quot;We hope to see you soon for tea.\u0026quot;); sem.leave(); }); }); webpackä¸­å·¥å‚å‡½æ•°ç”Ÿæˆå¤šä¸ªæ¨¡å— ä»¥åŠç¼–è¯‘æ¨¡å—æ—¶éƒ½é‡‡ç”¨äº†\nSemaphore æ¥æ§åˆ¶å¹¶å‘\nå›› åˆ©ç”¨Object.defineProperty é‡å†™getå‡½æ•°æ¥æ·»åŠ ä¸€äº›å†…å®¹è·å–çš„é€»è¾‘ let test = {arr: [1,2,2,3,4,5] } let res = {} Object.defineProperty(res, 'arr', { get() { // è¿™é‡Œå¯ä»¥è‡ªç”±æ·»åŠ è‡ªå·±éœ€è¦çš„é€»è¾‘ return test.arr.filter(item=\u0026gt;item\u0026gt;1); } }); console.log(res.arr)// [2, 2, 3, 4, 5] webpack ä¸­LoaderRunner.js ä¸­å°±é‡‡ç”¨äº†è¿™ä¸€æŠ€å·§å¯¹loaderè¿›è¡Œä¿¡æ¯é‡‡é›†\n","description":"","id":4,"section":"posts","tags":["å‰ç«¯","webpack"],"title":"webpack å­¦ä¹ æ€»ç»“ ä¸€","uri":"https://blog.syzh.fun/posts/hxd/webpack-notes-1/"},{"content":"  ç¨‹åºæ‰§è¡Œåˆ°deferè¯­å¥çš„æ—¶å€™, è¢«deferçš„å‡½æ•°çš„å®å‚ä¼šåœ¨æ­¤æ—¶è¢«æ±‚å€¼\n  1 2 3 4 5 6 7 8 9 10  func a() { i := 0 // è¢«deferçš„å‡½æ•°å®å‚ä¼šåœ¨æ­¤æ—¶è¢«æ±‚å€¼, è¿™é‡Œä¸º0  defer fmt.Println(i) // iè‡ªå¢, ä½†ä¸ä¼šå½±å“deferçš„å‡½æ•°  i++ return } //===========è¾“å‡º=========== 0       è¢«deferçš„å‡½æ•°è°ƒç”¨, æ‰§è¡Œé¡ºåºæ˜¯\u0026quot;åè¿›å…ˆå‡º\u0026rdquo;\n  deferçš„å‡½æ•°è°ƒç”¨ä¼šè¢«å‹å…¥ä¸€ä¸ªæ ˆä¸­ã€‚å½“å¤–å±‚å‡½æ•°è¿”å›æ—¶ï¼Œè¢«æ¨è¿Ÿçš„å‡½æ•°ä¼šæŒ‰ç…§åè¿›å…ˆå‡ºçš„é¡ºåºè°ƒç”¨ã€‚\n  å¦‚æœå‡½æ•°çš„è¿”å›å€¼æ˜¯å‘½åçš„, deferè¯­å¥ä¸­çš„å‡½æ•°å¯ä»¥è¯»å–æˆ–ä¿®æ”¹è¯¥å€¼\n  1 2 3 4 5 6 7 8 9  // ä¿®æ”¹å‘½åçš„è¿”å›å€¼ func c() (i int) { // åœ¨deferè¯­å¥ä¸­è‡ªå¢  defer func() { i++ }() // è¿™é‡Œiè¢«è®¾ä¸º1  return 1 } //=============è¾“å‡º============ 2     1 2 3 4 5 6 7 8  // è¿”å›å€¼æ˜¯åŒ¿åçš„, æ— æ³•è¢«deferä¿®æ”¹ func c() int { i := 1 defer func() { i++ }() return i } //=============è¾“å‡º============ 1       å®å‚ä¼°å€¼å’Œä¿®æ”¹è¿”å›å˜é‡çš„ä¾‹å­\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  func test() (x int) { // deferè¯­å¥çš„å®å‚ä¼šè¢«ç«‹åˆ»ä¼°å€¼, å› æ­¤å®å‚x==0  defer func(n int) { // å®å‚xä¼°å€¼ä¸º0, å› æ­¤å½¢å‚n==0  fmt.Printf(\u0026#34;in defer x as parameter: x = %d\\n\u0026#34;, n) // è¿™é‡Œçš„xæ˜¯å¤–é¢çš„x, å› æ­¤ä¸º9  fmt.Printf(\u0026#34;in defer x after return: x = %d\\n\u0026#34;, x) }(x) x = 7 // x==9  return 9 } // =============æ‰§è¡Œç»“æœ============== in defer x as parameter: x = 0 in defer x after return: x = 9       æœ€å¥½åœ¨è·å–èµ„æºä¹‹å, ç«‹åˆ»è°ƒç”¨defer\n  deferåœ¨å…¶æ‰€åœ¨çš„å‡½æ•°çš„æœ«å°¾æ‰§è¡Œ, å› æ­¤åœ¨forå¾ªç¯ä¸­ä½¿ç”¨æ—¶è¦æ³¨æ„\n  1 2 3 4 5 6 7 8 9 10  // æœ‰é—®é¢˜çš„å†™æ³• for _, filename := range filenames { f, err := os.Open(filename) if err != nil { return err } // é‡Šæ”¾èµ„æºçš„æ“ä½œç›´åˆ°æ‰€åœ¨å‡½æ•°æœ«å°¾æ‰æ‰§è¡Œ, å¦‚æœæ–‡ä»¶å¾ˆå¤š, å¯èƒ½å¯¼è‡´æ–‡ä»¶æè¿°ç¬¦ç”¨å°½  defer f.Close() // å¤„ç†æ–‡ä»¶ }     1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  // æ”¹è¿›å†™æ³• for _, filename := range filenames { if err := doFile(filename); err != nil { return err } } // æŠ½å–å¤„ç†å•ä¸ªæ–‡ä»¶çš„é€»è¾‘, æ­¤å‡½æ•°è¿”å›æ—¶å³å¯å…³é—­æ–‡ä»¶ func doFile(filename string) error { f, err := os.Open(filename) if err != nil { return err } defer f.Close() // å¤„ç†æ–‡ä»¶ }       ","description":"","id":5,"section":"posts","tags":["åç«¯","Golang"],"title":"Golang deferè¯­å¥ç”¨æ³•å°ç»“","uri":"https://blog.syzh.fun/posts/syzh/golang-defer/"},{"content":"  syncåŒ…æä¾›ä¼ ç»Ÿçš„å†…å­˜è®¿é—®çš„åŒæ­¥æœºåˆ¶\n  WaitGroup\n  ç­‰å¾…è‹¥å¹²goroutineæ‰§è¡Œå®Œæ¯•\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  // æ³¨æ„: å¦‚æœwgæ˜¯åœ¨é—­åŒ…ç¯å¢ƒä¸­ä½¿ç”¨, ç”±äºé—­åŒ…ä¸­æ•è·çš„æ˜¯å˜é‡æœ¬èº«, å› æ­¤ç›´æ¥ä½¿ç”¨wgå˜é‡å³å¯. ä½†å¦‚æœæ˜¯ä¸‹é¢ä»£ç è¿™æ ·, ä½œä¸ºå‡½æ•°çš„å‚æ•°è°ƒç”¨, åˆ™éœ€è¦ä¼ å¼•ç”¨æ¥ä¿è¯ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªwg  // ä¼ å…¥å…¬ç”¨çš„wgå¯¹è±¡ hello := func(wg *sync.WaitGroup, id int) { // æ‰§è¡Œå®Œæˆå, å†…éƒ¨å€¼-1  defer wg.Done() fmt.Printf(\u0026#34;Hello from %v!\\n\u0026#34;, id) } // å®šä¹‰goroutineæ•°é‡ const numGreeters = 5 // åˆå§‹åŒ–waitgroup var wg sync.WaitGroup // ä¸€æ¬¡æ€§å¢åŠ å†…éƒ¨å€¼, ä¹Ÿå¯ä»¥åœ¨forè¯­å¥ä¸­é€ä¸ªå¢åŠ  wg.Add(numGreeters) for i := 0; i \u0026lt; numGreeters; i++ { // wg.Add(1) å¦‚æœä½¿ç”¨é€ä¸ªå¢åŠ çš„æ–¹å¼  go hello(\u0026amp;wg, i+1) } // é˜»å¡, ç›´åˆ°å†…éƒ¨å€¼å˜ä¸º0 wg.Wait() //===========è¾“å‡º=============== // é¡ºåºä¸ç¡®å®š Hello from 1! Hello from 5! Hello from 2! Hello from 3! Hello from 4!       Mutex and RWMutex\n  ä¿æŠ¤å…³é”®åŒºåŸŸ(guard critical sections)\n  Mutex\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  var count int var lock sync.Mutex // ä¸‹é¢ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ increment := func() { lock.Lock() // ä½¿ç”¨defer, ç¡®ä¿é”è¢«é‡Šæ”¾  defer lock.Unlock() count++ fmt.Printf(\u0026#34;Incrementing: %d\\n\u0026#34;, count) } decrement := func() { lock.Lock() defer lock.Unlock() count-- fmt.Printf(\u0026#34;Decrementing: %d\\n\u0026#34;, count) }       RWMutex\n  å¯ä»¥åŒæ—¶æœ‰ä»»æ„å¤šä¸ªè¯»é”, æˆ–ä¸€ä¸ªå†™é”\n  è¯»é”æ˜¯å…±äº«çš„, å†™é”æ˜¯æ’ä»–çš„\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14  var mu sync.RWMutex var balance int func Balance() int { mu.RLock() // readers/shared lock  defer mu.RUnlock() return balance } func Deposit(amount int) { mu.Lock() // // writer/exclusive lock  defer mu.Unlock() balance += amount }         Cond\n  åœ¨æŸä¸ªç‚¹ç­‰å¾…æŸäº‹ä»¶(event)çš„å‘ç”Ÿ, åœ¨æ­¤ä¹‹å‰ä¿æŒé˜»å¡/æŒ‚èµ·çŠ¶æ€, ä½¿å…¶ä»–goroutineå¯ä»¥æ‰§è¡Œ\n  ç”¨äºnotifyçš„æ–¹æ³•\n Signal: é€šçŸ¥ç­‰å¾…æœ€ä¹…çš„goroutine, è¿™ä¸ªåŠŸèƒ½ä¹Ÿå¯ä»¥ç”¨channelå®ç°  runtimeç»´æŠ¤äº†ä¸€ä¸ªFIFOä¿å­˜ç­‰å¾…é€šçŸ¥çš„goroutine, å› æ­¤ä¼šé€šçŸ¥ç­‰å¾…æœ€ä¹…çš„goroutine   Broadcast: é€šçŸ¥æ‰€æœ‰goroutine, è¿™ä¸ªåŠŸèƒ½ç”¨channelä¸å¥½å®ç°    æ€§èƒ½æ¯”ä½¿ç”¨channelå®ç°å¥½å¾ˆå¤š\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  // å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå›ºå®šlenä¸º2çš„queue, æˆ‘ä»¬æƒ³åŠ å…¥10ä¸ªå…ƒç´ è¿›å». æˆ‘ä»¬å¸Œæœ›queueä¸€æœ‰å¤šä½™çš„ç©ºé—´, å°±èƒ½é€šçŸ¥æˆ‘ä»¬, è®©æˆ‘ä»¬æ’å…¥æ–°çš„å…ƒç´   // åˆ›å»ºä¸€ä¸ªcond, éœ€è¦ä¼ å…¥ä¸€ä¸ªsync.Lockeræ¥ä¿æŠ¤å…³é”®åŒºåŸŸ c := sync.NewCond(\u0026amp;sync.Mutex{}) // åˆå§‹åŒ–queue queue := make([]interface{}, 0, 10) // dequeueå‡½æ•° removeFromQueue := func(delay time.Duration) { // sleep delayçš„æ—¶é—´  time.Sleep(delay) // ä½¿ç”¨lockä¿æŠ¤å…³é”®åŒºåŸŸ  c.L.Lock() // dequeue  queue = queue[1:] fmt.Println(\u0026#34;Removed from queue\u0026#34;) // unlock, ç¦»å¼€å…³é”®åŒºåŸŸ  c.L.Unlock() // é€šçŸ¥ç­‰å¾…æœ€ä¹…çš„goroutine, ä¹Ÿå¯ä»¥ç”¨broadcastæ¥é€šçŸ¥æ‰€æœ‰  c.Signal() } for i := 0; i \u0026lt; 10; i++ { // è¿›å…¥å…³é”®åŒºåŸŸ  c.L.Lock() // éœ€è¦ä½¿ç”¨forå¾ªç¯æ¥æ£€æŸ¥æ¡ä»¶. å› ä¸ºæ¥åˆ°é€šçŸ¥å¹¶ä¸ä¸€å®šæ„å‘³ç€æˆ‘ä»¬åœ¨ç­‰å¾…çš„äº‹æƒ…å·²ç»å‘ç”Ÿ, æ‰€ä»¥éœ€è¦å†æ¬¡æ£€æŸ¥æ¡ä»¶  for len(queue) == 2 { // åœ¨å†…éƒ¨ä¼šå…ˆè°ƒç”¨unlock, ç„¶åç­‰å¾…. æ¥åˆ°é€šçŸ¥ç»§ç»­æ‰§è¡Œå, ä¼šè°ƒç”¨lock  c.Wait() } fmt.Println(\u0026#34;Adding to queue\u0026#34;) // enqueue  queue = append(queue, struct{}{}) // å¯åŠ¨goroutine, 1såæ‰§è¡Œdequeue  go removeFromQueue(1 * time.Second) // ç¦»å¼€å…³é”®åŒºåŸŸ  c.L.Unlock() }       Once\n  æ¯ä¸ªsync.Onceçš„å¯¹è±¡, åªèƒ½è°ƒç”¨1æ¬¡Doæ–¹æ³•, ä¹‹åçš„å¯¹Doçš„è°ƒç”¨æ— æ•ˆ.\n  1 2 3 4 5 6 7 8 9 10 11 12  var count int increment := func() { count++ } decrement := func() { count-- } var once sync.Once // ç¬¬ä¸€æ¬¡è°ƒç”¨Doæ–¹æ³•, æœ‰æ•ˆ once.Do(increment) // æ­¤æ¬¡è°ƒç”¨Doæ–¹æ³•æ— æ•ˆ once.Do(decrement) fmt.Printf(\u0026#34;Count: %d\\n\u0026#34;, count) // countä¸º1, onceå¯¹è±¡åªèƒ½æ‰§è¡Œä¸€æ¬¡DOæ–¹æ³•       Pool\n  åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ± , å…¶ä¸­çš„å¯¹è±¡å¯ä»¥å¤ç”¨(æ¯”å¦‚æ•°æ®åº“è¿æ¥), ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  myPool := \u0026amp;sync.Pool{ // ç”Ÿæˆæ–°å¯¹è±¡  New: func() interface{} { fmt.Println(\u0026#34;Creating new instance.\u0026#34;) return struct{}{} }, } // poolæ˜¯ç©ºçš„, å› æ­¤ä¼šåˆ›å»ºæ–°å¯¹è±¡ myPool.Get() // ä¸Šé¢åˆ›å»ºçš„å¯¹è±¡æ²¡æœ‰è¢«æ”¾å›, å› æ­¤ç°åœ¨poolä¸­è¿˜æ˜¯ç©ºçš„ // ç”±äºpoolæ˜¯ç©ºçš„, å› æ­¤ä¼šåˆ›å»ºæ–°å¯¹è±¡ instance := myPool.Get() // æ”¾å›å¯¹è±¡, ç»å¸¸é…åˆdeferä½¿ç”¨ myPool.Put(instance) // ç”±äºpoolä¸­æœ‰å¯¹è±¡, å› æ­¤ä¸ä¼šåˆ›å»ºæ–°å¯¹è±¡ myPool.Get() //============è¾“å‡º============ Creating new instance. Creating new instance.       ","description":"","id":6,"section":"posts","tags":["åç«¯","Golang","GoSync"],"title":"Golang syncåŒ…ç”¨æ³•å°ç»“","uri":"https://blog.syzh.fun/posts/syzh/golang-sync/"},{"content":"æä¾›äº†Golangäº¤æ›¿æ‰“å°çš„å‡ ä¸ªæ€è·¯: ä½¿ç”¨Goroutine, syncåŒ…ä¸­çš„WaitGroupå’ŒCond\n  ä½¿ç”¨unbuffered channelå®ç°\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  func PrintABUnbufferedChannel() { // ä½¿ç”¨2ä¸ªchannelå®ç°äº¤æ›¿è¿è¡Œ  c1 := make(chan struct{}) c2 := make(chan struct{}) // æ‰“å°aaaçš„å‡½æ•°, å¯¹2ä¸ªchannelæ‰§è¡Œsendæ“ä½œ  PrintA := func() { for { c1 \u0026lt;- struct{}{} fmt.Println(\u0026#34;aaa\u0026#34;) time.Sleep(1 * time.Second) c2 \u0026lt;- struct{}{} } } // æ‰“å°bbbçš„å‡½æ•°, å¯¹2ä¸ªchannelæ‰§è¡Œreceiveæ“ä½œ  PrintB := func() { for { \u0026lt;-c2 fmt.Println(\u0026#34;bbb\u0026#34;) time.Sleep(1 * time.Second) \u0026lt;-c1 } } // å…ˆæ‰“å°aaa  go func() { \u0026lt;-c1 }() go PrintA() go PrintB() time.Sleep(1 * time.Hour) }       ä½¿ç”¨sync.Condé…åˆsync.WaitGroupå®ç°\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54  func PrintABCond() { // ä½¿ç”¨2ä¸ªcondå®ç°äº¤æ›¿è¿è¡Œ  c1 := sync.NewCond(\u0026amp;sync.Mutex{}) c2 := sync.NewCond(\u0026amp;sync.Mutex{}) // ä½¿ç”¨waitgroupåè°ƒé¡ºåº, ç¡®ä¿printA, printBå…ˆå¯åŠ¨, å†å‘é€ç¬¬ä¸€ä¸ªsignal  var wg sync.WaitGroup // æ‰“å°aaaçš„å‡½æ•°, ç­‰å¾…c1, é€šçŸ¥c2  printA := func() { // ç¡®ä¿printAå¯åŠ¨æ—©äºç¬¬ä¸€ä¸ªsignal  wg.Done() for { c1.L.Lock() // ç­‰å¾…ä¿¡å·  c1.Wait() fmt.Println(\u0026#34;aaa\u0026#34;) time.Sleep(1 * time.Second) // å‘é€ä¿¡å·  c2.Signal() c1.L.Unlock() } } // æ‰“å°bbbçš„å‡½æ•°, ç­‰å¾…c2, é€šçŸ¥c1  printB := func() { // ç¡®ä¿printBå¯åŠ¨æ—©äºç¬¬ä¸€ä¸ªsignal  wg.Done() for { c2.L.Lock() // ç­‰å¾…ä¿¡å·  c2.Wait() fmt.Println(\u0026#34;bbb\u0026#34;) time.Sleep(1 * time.Second) // å‘é€ä¿¡å·  c1.Signal() c2.L.Unlock() } } wg.Add(2) // å…ˆæ‰“å°aaa  go func() { // ç­‰å¾…printA, printBå¯åŠ¨å, å†å‘é€ç¬¬ä¸€ä¸ªsignal  wg.Wait() c1.Signal() }() go printA() go printB() time.Sleep(1 * time.Hour) }       ä½¿ç”¨for-selectè¯­å¥å®ç°, ä¸æ–¹æ³•1ç±»ä¼¼\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29  func PrintABForSelect() { c1 := make(chan struct{}) c2 := make(chan struct{}) printAB := func() { for { select { case \u0026lt;-c1: fmt.Println(\u0026#34;aaa\u0026#34;) time.Sleep(1 * time.Second) c2 \u0026lt;- struct{}{} case \u0026lt;-c2: fmt.Println(\u0026#34;bbb\u0026#34;) time.Sleep(1 * time.Second) c1 \u0026lt;- struct{}{} } } } go func() { c1 \u0026lt;- struct{}{} }() go printAB() go printAB() time.Sleep(1 * time.Hour) }       ","description":"","id":7,"section":"posts","tags":["åç«¯","Golang","Goroutine","GoChannel","GoSync"],"title":"Golangäº¤æ›¿æ‰“å°çš„å‡ ç§å®ç°æ–¹å¼","uri":"https://blog.syzh.fun/posts/syzh/golang-goroutine-coordinate/"},{"content":"ä¸‰è‰²æ ‡è®°-æ¸…é™¤ç®—æ³•(tricolor mark-and-sweep algorithm)\n æŠŠheapä¸­çš„å¯¹è±¡, ç”¨é»‘è‰², ç°è‰², ç™½è‰²è¿›è¡Œæ ‡è®°  é»‘è‰²å¯¹è±¡: å·²ç»ä»¥å…¶ä¸ºrootæ‰§è¡Œè¿‡å¯è¾¾æ€§åˆ†æçš„å¯¹è±¡ ç°è‰²å¯¹è±¡: éœ€è¦ä½†è¿˜æœªä»¥å…¶ä¸ºrootæ‰§è¡Œè¿‡å¯è¾¾æ€§åˆ†æçš„å¯¹è±¡ ç™½è‰²å¯¹è±¡: ä»gc rootæ— æ³•è¢«è§¦è¾¾çš„å¯¹è±¡, å¯èƒ½è¢«åƒåœ¾å›æ”¶   åƒåœ¾å›æ”¶è¿‡ç¨‹  åƒåœ¾å›æ”¶å¼€å§‹æ—¶, æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰². æ‰€æœ‰rootå¯¹è±¡è¢«æ ‡è®°ä¸ºç°è‰². rootå¯¹è±¡æŒ‡ç¨‹åºå¯ä»¥ç›´æ¥è®¿é—®çš„å¯¹è±¡, åŒ…å«å…¨å±€å˜é‡, ä½äºæ ˆä¸Šçš„æ•°æ®. åƒåœ¾å›æ”¶å™¨é€‰æ‹©ä¸€ä¸ªç°è‰²å¯¹è±¡, æŠŠå®ƒæ ‡è®°ä¸ºé»‘è‰², å¯»æ‰¾å…¶å¯ä»¥è§¦è¾¾çš„ç™½è‰²å¯¹è±¡, å¹¶æŠŠå®ƒä»¬æ ‡è®°ä¸ºç°è‰². ç›´åˆ°æŠŠæ‰€æœ‰ç°è‰²å¯¹è±¡éƒ½å¤„ç†è¿‡ä¸€é æ­¤æ—¶çš„ç™½è‰²å¯¹è±¡è¯´æ˜æ— æ³•è¢«è§¦è¾¾, å› æ­¤å¯ä»¥è¢«åƒåœ¾å›æ”¶ å¦‚æœåœ¨åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­, æŸä¸ªç°è‰²å¯¹è±¡å˜å¾—ä¸å¯è§¦è¾¾äº†, åˆ™å®ƒä¼šåœ¨ä¸‹æ¬¡åƒåœ¾å›æ”¶æ—¶è¢«æ¸…ç†   æ ‡è®°è¿‡ç¨‹ä¸­, æ‰§è¡Œä¸­çš„åº”ç”¨ç¨‹åºè¢«ç§°ä¸ºmutator, mutatoræœ‰ä¸€ä¸ªå‡½æ•°write barrier. å½“heapä¸­çš„æŸä¸ªå¯¹è±¡è¢«ä¿®æ”¹äº†, è¯´æ˜è¯¥å¯¹è±¡å¯è¢«è§¦è¾¾, åˆ™write barrierä¼šæŠŠæ­¤å¯¹è±¡æ ‡è®°ä¸ºç°è‰² å½“æŸchannelæ— æ³•è¢«è§¦è¾¾æ—¶, å³ä½¿å…¶æœªè¢«close, ä¹Ÿä¼šè¢«åƒåœ¾å›æ”¶, æ¸…ç†å…¶å ç”¨çš„èµ„æº æ‰‹åŠ¨è§¦å‘GC: runtime.GC(), æ­¤æ“ä½œä¼šé˜»å¡è°ƒç”¨è€…, å¹¶å¯èƒ½é˜»å¡æ•´ä¸ªç¨‹åº marké˜¶æ®µ, æ ‡è®°å¯¹è±¡; æ²¡æœ‰ç°è‰²å¯¹è±¡å, å¼€å§‹sweepé˜¶æ®µ goçš„åƒåœ¾å›æ”¶æ˜¯ä¸å…¶ä»–goroutineå¹¶å‘æ‰§è¡Œçš„  ","description":"","id":8,"section":"posts","tags":["åç«¯","Golang","åƒåœ¾å›æ”¶"],"title":"Golangåƒåœ¾å›æ”¶-ä¸‰è‰²ç®—æ³•æ¦‚è§ˆ","uri":"https://blog.syzh.fun/posts/syzh/golang-garbage-collector-tricolor/"},{"content":"  é—®é¢˜è¡¨ç°\n  ä½¿ç”¨ä¸‹æ ‡è·å–å­—ç¬¦ä¸²çš„å­—ç¬¦æ—¶, å¯èƒ½å¾—åˆ°å¥‡æ€ªçš„å­—ç¬¦\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  func main() { s := \u0026#34;hello\u0026#34; fmt.Printf(\u0026#34;%c\\n\u0026#34;, s[1]) s = \u0026#34;ä½ å¥½\u0026#34; fmt.Printf(\u0026#34;%c\\n\u0026#34;, s[1]) } //============è¾“å‡º===========  e Â½       é—®é¢˜åŸå› \n golangæ˜¯ä»¥utf8æ ¼å¼ä¿å­˜å­—ç¬¦ä¸²çš„, å­—ç¬¦ä¸²çš„ä¸‹æ ‡æ“ä½œ, è®¿é—®çš„æ˜¯å­—èŠ‚, è€Œä¸æ˜¯å­—ç¬¦. lenå‡½æ•°è¾“å‡ºçš„ä¹Ÿæ˜¯å­—èŠ‚æ•°, å¦‚len(\u0026quot;hello\u0026quot;)==5, len(\u0026quot;ä½ å¥½\u0026quot;)==6    é¿å…æ–¹å¼\n  æŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸º[]rune/[]int32, æˆ–è€…ä½¿ç”¨rangeéå†\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  func main() { s := \u0026#34;ä½ å¥½\u0026#34; // å¼ºè½¬ä¸º[]rune  fmt.Printf(\u0026#34;%c\\n\u0026#34;, []rune(s)[1]) fmt.Println() // ä½¿ç”¨rangeéå†  for _, c := range s { fmt.Printf(\u0026#34;%c\\n\u0026#34;, c) } } //===============è¾“å‡º=================  å¥½ ä½  å¥½       ","description":"","id":9,"section":"posts","tags":["åç«¯","Golang","è¸©å‘"],"title":"Golangè¸©å‘æ€»ç»“-ä½¿ç”¨ä¸‹æ ‡è·å–å­—ç¬¦ä¸²çš„å­—ç¬¦","uri":"https://blog.syzh.fun/posts/syzh/golang-pitfall-string-subscript/"},{"content":"  é—®é¢˜è¡¨ç°\n  goroutineä¸­æ•è·çš„å¾ªç¯å˜é‡, éƒ½ä¸ºå¾ªç¯æœ€åçš„å€¼\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  func main() { for i, v := range []string{\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;} { // goroutineä¸­æ•è·å¾ªç¯å˜é‡  go func() { fmt.Printf(\u0026#34;index: %v, value: %v\\n\u0026#34;, i, v) }() } // æ­¤å¤„åº”è¯¥ä½¿ç”¨workgroupå®ç°, ä¸ºäº†ç®€å•ä½¿ç”¨äº†sleep  time.Sleep(1 * time.Second) } //================è¾“å‡º==============  index: 4, value: e index: 4, value: e index: 4, value: e index: 4, value: e index: 4, value: e       é—®é¢˜åŸå› \n goroutineä¸­æ•è·çš„ä¸æ˜¯\u0026quot;å€¼\u0026rdquo;, è€Œæ˜¯\u0026quot;æœ‰åœ°å€çš„å˜é‡\u0026rdquo;. forå¾ªç¯å¯èƒ½ä¼šå…ˆç»“æŸ, ä¹‹åå„ä¸ªgoroutineæ‰å¼€å§‹æ‰§è¡Œ. å› æ­¤å¾—åˆ°çš„æ˜¯å˜é‡çš„æœ€ç»ˆå€¼    é¿å…æ–¹å¼\n  åœ¨goroutineå¯åŠ¨çš„å‡½æ•°ä¸­, æŠŠå˜é‡ä½œä¸ºå‚æ•°æ•è·\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  func main() { for i, v := range []string{\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;} { // æŠŠå¾ªç¯å˜é‡ä½œä¸ºå‚æ•°ä¼ å…¥  go func(i int, v string) { // i, væ˜¯å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡  fmt.Printf(\u0026#34;index: %v, value: %v\\n\u0026#34;, i, v) }(i, v) } time.Sleep(1 * time.Second) } //================è¾“å‡º==============  index: 0, value: a index: 1, value: b index: 4, value: e index: 3, value: d index: 2, value: c       ","description":"","id":10,"section":"posts","tags":["åç«¯","Golang","è¸©å‘","Goroutine"],"title":"Golangè¸©å‘æ€»ç»“-å¾ªç¯ä¸­ä½¿ç”¨Goroutineä¸­æ•è·å‚æ•°","uri":"https://blog.syzh.fun/posts/syzh/golang-pitfall-for-goroutine/"},{"content":"  é—®é¢˜è¡¨ç°\n  é—­åŒ…ä¸­æ•è·çš„å¾ªç¯å˜é‡, éƒ½ä¸ºå¾ªç¯æœ€åçš„å€¼\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  func main() { // ä¿å­˜å‡½æ•°é—­åŒ…  var s []func() for i, v := range []string{\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;} { s = append(s, func() { // æ•è·i, v, ä¿å­˜åœ¨é—­åŒ…ä¸­  fmt.Printf(\u0026#34;index: %v, value: %v\\n\u0026#34;, i, v) }) } for _, f := range s { f() } } // ====================è¾“å‡º===========================  index: 4, value: e index: 4, value: e index: 4, value: e index: 4, value: e index: 4, value: e       é—®é¢˜åŸå› \n é—­åŒ…ä¸­æ•è·çš„ä¸æ˜¯\u0026quot;å€¼\u0026rdquo;, è€Œæ˜¯\u0026quot;æœ‰åœ°å€çš„å˜é‡\u0026rdquo;. æœ€ç»ˆæ‰§è¡Œæ—¶, æ ¹æ®å˜é‡å¯»å€, å¾—åˆ°çš„æ˜¯å˜é‡æœ€åçš„å€¼    é¿å…æ–¹å¼\n  åœ¨å¾ªç¯ä¸­, é‡æ–°å£°æ˜è¦æ•è·çš„å˜é‡. ç”±äºæ˜¯å•ä¸ªå¾ªç¯çš„å±€éƒ¨å˜é‡, åœ¨å…¶ä½œç”¨åŸŸç»“æŸå‰, ä¼šè¿›è¡Œevaluate\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  func main() { // ä¿å­˜å‡½æ•°é—­åŒ…  var s []func() for i, v := range []string{\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;, \u0026#34;e\u0026#34;} { // é‡æ–°å£°æ˜è¦æ•è·çš„å˜é‡  i, v := i, v s = append(s, func() { // æ•è·i, v, ä¿å­˜åœ¨é—­åŒ…ä¸­  fmt.Printf(\u0026#34;index: %v, value: %v\\n\u0026#34;, i, v) }) } for _, f := range s { f() } } // ====================è¾“å‡º===========================  index: 0, value: a index: 1, value: b index: 2, value: c index: 3, value: d index: 4, value: e       ","description":"","id":11,"section":"posts","tags":["åç«¯","Golang","è¸©å‘","é—­åŒ…"],"title":"Golangè¸©å‘æ€»ç»“-å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…æ•è·å‚æ•°","uri":"https://blog.syzh.fun/posts/syzh/golang-pitfall-for-closure/"},{"content":"  é—®é¢˜è¡¨ç°\n  å…·ä½“ç±»å‹çš„nilå€¼, èµ‹å€¼ç»™æ¥å£å€¼å˜é‡å, è¢«åˆ¤å®šä¸ä¸ºnil\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28  func main() { // *bytes.Buffer, é›¶å€¼ä¸ºnil  var b *bytes.Buffer if b == nil { fmt.Println(\u0026#34;å¤–é¢çš„bç­‰äºnil\u0026#34;) } else { fmt.Println(\u0026#34;å¤–é¢çš„bä¸ç­‰äºnil\u0026#34;) } f := func(b io.Writer) { if b == nil { fmt.Println(\u0026#34;é‡Œé¢çš„bç­‰äºnil\u0026#34;) } else { fmt.Println(\u0026#34;é‡Œé¢çš„bä¸ç­‰äºnil\u0026#34;) } } // æŠŠbä¼ å…¥å‡½æ•°  f(b) } //===========è¾“å‡º===============  å¤–é¢çš„bç­‰äºnil é‡Œé¢çš„bä¸ç­‰äºnil       é—®é¢˜åŸå› \n golangä¸­çš„æ¥å£å€¼, é™¤äº†æœ‰è‡ªå·±çš„ç±»å‹typeå¤–, è¿˜æœ‰åŠ¨æ€ç±»å‹(dynamic type)å’ŒåŠ¨æ€å€¼(dynamic value). æ¥å£å€¼å¦‚æœè¦è¢«åˆ¤æ–­ä¸ºnil, éœ€è¦åŠ¨æ€ç±»å‹å’ŒåŠ¨æ€å€¼éƒ½ä¸ºnil. å¯ä»¥é€šè¿‡fmtçš„\u0026rdquo;%T\u0026rdquo;, \u0026ldquo;%v\u0026quot;è§‚å¯ŸåŠ¨æ€ç±»å‹å’ŒåŠ¨æ€å€¼    æ‰“å°åŠ¨æ€ç±»å‹å’ŒåŠ¨æ€å€¼\n  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38  func main() { var b *bytes.Buffer fmt.Printf(\u0026#34;å¤–é¢çš„bç±»å‹ä¸º%T\\n\u0026#34;, b) fmt.Printf(\u0026#34;å¤–é¢çš„bå€¼ä¸º%v\\n\u0026#34;, b) if b == nil { fmt.Println(\u0026#34;å¤–é¢çš„bç­‰äºnil\u0026#34;) } else { fmt.Println(\u0026#34;å¤–é¢çš„bä¸ç­‰äºnil\u0026#34;) } fmt.Println(\u0026#34;\u0026#34;) f := func(b io.Writer) { fmt.Printf(\u0026#34;é‡Œé¢çš„bç±»å‹ä¸º%T\\n\u0026#34;, b) fmt.Printf(\u0026#34;é‡Œé¢çš„bå€¼ä¸º%v\\n\u0026#34;, b) if b == nil { fmt.Println(\u0026#34;é‡Œé¢çš„bç­‰äºnil\u0026#34;) } else { fmt.Println(\u0026#34;é‡Œé¢çš„bä¸ç­‰äºnil\u0026#34;) } } f(b) } //==============è¾“å‡º=================  å¤–é¢çš„bç±»å‹ä¸º*bytes.Buffer å¤–é¢çš„bå€¼ä¸º\u0026lt;nil\u0026gt; å¤–é¢çš„bç­‰äºnil é‡Œé¢çš„bç±»å‹ä¸º*bytes.Buffer é‡Œé¢çš„bå€¼ä¸º\u0026lt;nil\u0026gt; é‡Œé¢çš„bä¸ç­‰äºnil       ","description":"","id":12,"section":"posts","tags":["åç«¯","Golang","è¸©å‘"],"title":"Golangè¸©å‘æ€»ç»“-æ¥å£å€¼æ˜¯å¦ç­‰äºnil","uri":"https://blog.syzh.fun/posts/syzh/golang-pitfall-interface-value-nil/"},{"content":"æœ€è¿‘åœ¨ç”¨Golangæ­å»ºåšå®¢åç«¯æ—¶, é‡åˆ°ä¸€ä¸ªé—®é¢˜: æ•°æ®åœ¨ä»mysqlåˆ°æ¥å£è¾“å‡ºçš„jsonè½¬åŒ–ä¸­, éœ€è¦åšå­—æ®µæ˜ å°„. å¸¸è§„çš„æ–¹æ³•æ˜¯å†™db tagå’Œjson tag, è‡ªåŠ¨è¿›è¡Œè½¬æ¢. è¿™ç§æ–¹å¼æœ‰ç‚¹éº»çƒ¦, å°¤å…¶structå’Œå­—æ®µå¤šèµ·æ¥çš„æ—¶å€™. æˆ‘çš„åœºæ™¯æ˜¯mysqlå­—æ®µä¸ºsnake_case, structä¸ºCamelCase, jsonå­—æ®µä¸ºsnake_case, å°±æƒ³ç€ç”¨ä»£ç æ¥å®Œæˆè½¬æ¢\nä»£ç ç¤ºä¾‹å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  // åšå®¢æ–‡ç« struct type Post struct { Content string Cover string CreatedAt time.Time FamilyID int ID int Slug string Status int Title string UpdatedAt time.Time } // structå’Œjsonäº’è½¬ var keyMatchRegex = regexp.MustCompile(`\u0026#34;\\w+\u0026#34;:`) var wordBarrierRegex = regexp.MustCompile(`([a-z])([A-Z])`) // é‡å†™Responseç±»å‹çš„MarshalJSONæ–¹æ³• func (resp Response) MarshalJSON() ([]byte, error) { // åˆ›å»ºæ­¤ç±»å‹, é˜²æ­¢é€’å½’  type Response_ Response marshalled, err := json.Marshal(Response_(resp)) // æ­£åˆ™æ›¿æ¢  converted := keyMatchRegex.ReplaceAllFunc( marshalled, func(match []byte) []byte { return bytes.ToLower(wordBarrierRegex.ReplaceAll( match, []byte(`${1}_${2}`), )) }, ) return converted, err } // structå’Œdbå­—æ®µäº’è½¬ var DB *sqlx.DB func init(){ // ä½¿ç”¨sqlxåŒ…ä¸æ•°æ®åº“äº¤äº’  DB = sqlx.MustConnect(\u0026#34;mysql\u0026#34;, \u0026#34;db connection\u0026#34;) // æ”¯æŒè‡ªå®šä¹‰MapperFunc, ä½¿ç”¨strcaseåŒ…ä¸­çš„ToSnake  DB.MapperFunc(strcase.ToSnake) DB = DB.Unsafe() }   ","description":"","id":13,"section":"posts","tags":["åç«¯","Golang"],"title":"Golangé¿å…ä½¿ç”¨struct tag","uri":"https://blog.syzh.fun/posts/syzh/golang-reduce-json-db-tag/"},{"content":"jsçš„ç»§æ‰¿æ€»ç»“ æœ¬è´¨éƒ½æ˜¯åŸå‹é“¾ï¼Œè®¾ç½®å­ç±»çš„prototypeï¼Œåº”ç”¨çš„æ—¶å€™å®ä¾‹å±æ€§å®šä¹‰åœ¨å®ä¾‹ä¸Šï¼Œé€šç”¨æ–¹æ³•å®šä¹‰åœ¨åŸå‹é“¾ä¸Šï¼Œè¾¾åˆ°è¾ƒå¥½çš„å¤ç”¨å’Œæ‰©å±•æ•ˆæœã€‚ æ–¹æ³•ä¸€ ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹ function Father() { this.property = true; // å®ä¾‹å±æ€§ } Father.prototype.getFatherValue = function(){ return this.property; // é€šç”¨æ–¹æ³• } function Son(){ this.sonProperty = false; } Son.prototype = new Father();//ç»§æ‰¿ Son.prototype.getSonProperty = function(){ return this.sonProperty } var instance = new Son(); instance.getFatherValue() æ–¹æ³•äºŒ object.create æ­¤æ–¹æ³•æ˜¯ã€Šä½ ä¸çŸ¥é“çš„jsã€‹æ‰€æ¨èçš„æ–¹æ³•ï¼Œå·²ç»è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ­¤æ–¹æ³•å¯ä»¥é¿å… new Father() æœ‰å¯èƒ½ä¼šå¸¦æ¥çš„è´Ÿé¢ä½œç”¨\nfunction Father() { this.property = true; // å®ä¾‹å±æ€§ } Father.prototype.getFatherValue = function(){ console.log('father') return this.property; // é€šç”¨æ–¹æ³• } function Son(){ Father.apply(this,arguments) // å­ç±»å€Ÿç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³• å®ç°ç»§æ‰¿å®ä¾‹å±æ€§ } // æ³¨æ„æ˜¯ Father.prototype Son.prototype = Object.create(Father.prototype,{ constructor: { value: Father; // å¼¥è¡¥è¿™ç§æ–¹æ³•çš„ä¸è¶³ } }) // æˆ–è€…æ·»åŠ ä¸€å¥ // Son.constructor = Father Son.prototype.getSonProperty = function(){ return this.sonProperty } var instance = new Son(); instance.getFatherValue() æ–¹æ³•ä¸‰ es6 class æœ¬è´¨è¿˜æ˜¯åŸå‹é“¾çš„è¯­æ³•ç³–ï¼Œä½†æ˜¯å¯¹äºé¢å‘å¯¹è±¡å¼€å‘å‹å¥½\nclass Father { constructor(name) { this.name = name; // å¢åŠ åˆ°å®ä¾‹ä¸Š } // è¿™é‡Œå£°æ˜çš„æ™®é€šæ–¹æ³•éƒ½æ·»åŠ åˆ°åŸå‹ä¸Š drink() { console.log('father drink') } } class Son extends Father { // å…³é”®æ˜¯extends constructor(name) { // å¦‚æœæ²¡æœ‰constructor é»˜è®¤ä½¿ç”¨çˆ¶ç±»çš„ // è¿™é‡Œçš„superæŒ‡å‘çš„æ˜¯çˆ¶ç±» é»˜è®¤é‡Œé¢çš„thiså°±æ˜¯å­ç±» super(name); // Animal.call(this) } drink() { // super = Super.prototype è¿™ä¸ªsuperä¸èƒ½å•ç‹¬æ‰“å° super.drink(); console.log('son drink') } } let son = new Son(); son.drink() // super æŒ‡å‘æœ‰ä¸¤ç§å¯èƒ½ åœ¨constructor å’Œ staticä¸­æŒ‡å‘çš„æ˜¯çˆ¶ç±» // åœ¨å­ç±»çš„åŸå‹æ–¹æ³•ä¸­æŒ‡å‘çš„æ˜¯çˆ¶ç±»åŸå‹ // é™æ€æ–¹æ³• å°±æ˜¯é€šè¿‡ç±»æ¥è°ƒç”¨çš„æ–¹æ³• æ–¹æ³•å›› Object.setPrototypeOf åŸç† æ–¹æ³•è®¾ç½®ä¸€ä¸ªæŒ‡å®šçš„å¯¹è±¡çš„åŸå‹ ( å³, å†…éƒ¨[[Prototype]]å±æ€§ï¼‰ï¼Œmdn ä»æ€§èƒ½è€ƒè™‘ä¸å»ºè®® é“¾æ¥\n// å°±æ˜¯ç›´æ¥ä¿®æ”¹ __proto__ function Father() { this.property = true; // å®ä¾‹å±æ€§ } Father.prototype.getFatherValue = function(){ console.log(123) return this.property; // é€šç”¨æ–¹æ³• } function Son(){ this.sonProperty = false; } Object.setPrototypeOf(Son.prototype,Father.prototype) Son.prototype.getSonProperty = function(){ return this.sonProperty } var instance = new Son(); instance.getFatherValue() ","description":"","id":14,"section":"posts","tags":["å‰ç«¯","JavaScript"],"title":"JavaScriptçš„ç»§æ‰¿æ€»ç»“","uri":"https://blog.syzh.fun/posts/hxd/js-inheritance/"},{"content":"è™½ç„¶åšå®¢ä¸å¤š, å†™åšå®¢ä»¥æ¥çš„æ—¶é—´ä¸é•¿, ä½†æ˜¯æŠ˜è…¾å¹¶ä¸å°‘\u0026hellip;è®°å½•ä¸€ä¸‹è¿™ä¸ªåšå®¢çš„æŠ˜è…¾å†ç¨‹ Golangæ—¶æœŸ æœ€åˆæ˜¯æƒ³å†™ä¸ªåšå®¢, å·©å›ºä¸€ä¸‹GolangçŸ¥è¯†çš„, ä»¥åŠhxdåŒå­¦åˆšåˆšå­¦äº†react, ä¹Ÿå¯ä»¥ç»ƒç»ƒæ‰‹. å¤§éƒ¨åˆ†å‡†å¤‡å·¥ä½œä¹Ÿæ˜¯è¿™æ®µæ—¶é—´åšçš„\nè´­ä¹°åŸŸå æœ€åˆçš„åŸŸåæ˜¯åœ¨googleä¹°çš„, è¦20$ä¸€å¹´, åæ¥å¶ç„¶å‘ç°é˜¿é‡Œäº‘æœ‰åœ¨å–åŸŸå, å°±æ˜¯å½“å‰è¿™ä¸ª, ä¸åˆ°200å—/10å¹´, è§‰å¾—æŒºåˆé€‚, æœæ–­å°±ä¹°äº†\nè´­ä¹°æœåŠ¡å™¨ è¶ç€è…¾è®¯äº‘ææ´»åŠ¨, 88Â¥/å¹´ä¹°çš„, åæ¥å‘ç°æ€§èƒ½ç¡®å®ä¸è¡Œ\u0026hellip;ä¸è¿‡88ä¸€å¹´ä¹Ÿä¸èƒ½è¦æ±‚å¤ªé«˜å•¦\nå¼€å‘è¯­è¨€çš„é€‰æ‹© å½“æ—¶å­¦äº†Golangå’ŒRust, æƒ³ç€åŒºåŒºä¸€ä¸ªåšå®¢, ç”¨Rustå²‚ä¸æ˜¯æ€é¸¡ç”¨ç‰›åˆ€äº†, åŠ ä¸ŠGolangåœ¨æœåŠ¡ç«¯å¼€å‘ä¸Šçš„ä¼˜åŠ¿, äºæ˜¯é€‰æ‹©äº†Golangæ¥å¼€å‘åç«¯. ä¹Ÿä¸ºåæ¥ç”¨Rusté‡å†™ä¹°ä¸‹äº†ä¼ç¬”\u0026hellip;\nWebæ¡†æ¶çš„é€‰æ‹© å…¶å®GolangåšæœåŠ¡ç«¯å¼€å‘å·²ç»å¤Ÿæ–¹ä¾¿äº†, ä¹Ÿæœ‰å¾ˆå¤šäººæ¨èä¸ä½¿ç”¨æ¡†æ¶. åŸºäºåœ¨reddité‡Œçš„æ¢ç´¢, é€‰æ‹©äº†ä¸€ä¸ªç®€å•çš„router: go-chi\nORMçš„é€‰æ‹© æ²¡æœ‰é€‰æ‹©GORM, XORMç­‰, æ„Ÿè§‰æœ‰ç‚¹é‡é‡çº§äº†. å¤šæ–¹æ¢ç´¢, é€‰æ‹©äº†sqlx\nhttpsè¯ä¹¦ ä½¿ç”¨äº†acme.sh, å…è´¹, ä¸”æ”¯æŒè‡ªåŠ¨æ›´æ–°\nRustæ—¶æœŸ å¤§æ¦‚2019å¹´12æœˆçš„æ—¶å€™, Rustæ”¯æŒäº†async/awaitè¯­æ³•, äºæ˜¯æƒ³åŠ¨æ‰‹è¯•ä¸€è¯•, æ‹¿åšå®¢å¼€åˆ€äº†\nWebæ¡†æ¶çš„é€‰æ‹© Rustä½œä¸ºæ€§èƒ½è‘—ç§°çš„è¯­è¨€, å¾ˆå¤šæ¡†æ¶ä¹Ÿéƒ½åŒæ—¶æ”¯æŒå¼‚æ­¥. æ¯”å¦‚actix-web, warp, tower-web, tide. æœ€ç»ˆé€‰æ‹©äº†ç›¸å¯¹ç®€å•çš„tideæ¡†æ¶(ä¸tideå¯¹åº”, è¿˜æœ‰ä¸€ä¸ªå¼‚æ­¥http client: surf. äºŒè€…éƒ½æ˜¯http-rsçš„ä½œå“, å¯“æ„surf the tide)\nMysql Client Rustç¤¾åŒºå½“æ—¶ç°æœ‰çš„Mysql Client, å¤§å¤šæ•°ä¸æ”¯æŒå¼‚æ­¥, æ”¯æŒå¼‚æ­¥çš„é‡Œé¢, åˆå¤§å¤šæ•°ä¸æ”¯æŒMysql\u0026hellip;æœ€ç»ˆé€‰æ‹©äº†sqlx, æ”¯æŒç¼–è¯‘æ—¶æ£€æŸ¥sqlè¯­å¥\nä¸Golangåšå®¢çš„æ€§èƒ½å¯¹æ¯” å†™å®Œå, ç”¨wrkå·¥å…·å¯¹æ¯”äº†ä¸‹äºŒè€…çš„æ€§èƒ½, Rustç‰ˆæœ¬çš„è¿˜æ˜¯æ¯”è¾ƒå¿«. å½“ç„¶Golangç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯åŒæ­¥çš„é€»è¾‘, å¦‚æœä½¿ç”¨Goroutineè¯·æ±‚æ•°æ®åº“, å¯èƒ½ä¹Ÿä¼šå¾ˆå¿«.\nGohugoæ—¶æœŸ æœåŠ¡å™¨è¿˜æœ‰å‡ ä¸ªæœˆå°±è¦åˆ°æœŸäº†, ä¸€æƒ³åˆ°åˆè¦é…ç½®Mysql, Redis, ä»¥åŠæœªå®Œæˆçš„elasticsearchæœç´¢, è¯„è®ºåŠŸèƒ½ç­‰, å°±æœ‰ç‚¹å¤´å¤§. è™½è¯´ç”¨dockerå¯ä»¥è§£å†³, ä½†æ˜¯è¿˜æœ‰ä»€ä¹ˆæ¯”é™æ€ç½‘ç«™æ›´çœå¿ƒå‘¢\u0026hellip;\né™æ€ç½‘ç«™ç”Ÿæˆå™¨çš„é€‰æ‹© è¿™ä¸ªæ²¡åšå¤ªå¤šæ¯”è¾ƒ, äº†è§£åˆ°æœ‰Hexo, Gohugo, Rust Zolaç­‰ç­‰. Gohugoå„æ–¹é¢éƒ½æ»¡è¶³æˆ‘éœ€æ±‚, å°±é€‰äº†è¿™ä¸ª\nHugo themeçš„é€‰æ‹© é™æ€ç½‘ç«™çš„è¯, themeåº”è¯¥æ˜¯æœ€é‡è¦çš„é€‰æ‹©äº†. åˆ—ä¸¾äº†ä¸€ä¸‹è‡ªå·±éœ€è¦çš„åŠŸèƒ½:\n é¦–é¡µåˆ—è¡¨ç®€æ´ æ”¯æŒæ˜æš—é…è‰² æ”¯æŒåˆ†ç±»/æ ‡ç­¾ æ–‡ç« æ”¯æŒæ˜¾ç¤ºç›®å½• åˆ—è¡¨ä¸­çš„æ–‡ç« , æ”¯æŒé…å›¾ æœ€å¥½æ”¯æŒæœç´¢ æœ€å¥½æ”¯æŒæ‰‹æœºæµè§ˆ   æ¯”è¾ƒäº†ä¸€äº›, æŠŠèŒƒå›´ç¼©å°åœ¨zzo, even, jane, æœ€ç»ˆé€‰æ‹©äº†zzo(zzoè¿˜æ”¯æŒç›¸å†Œ, æ¼”ç¤º, é™ˆåˆ—æŸœ, å‡ºç‰ˆç‰©ç­‰åŠŸèƒ½, æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç ”ç©¶ä¸‹)\nè¯„è®ºç³»ç»Ÿçš„é€‰æ‹© æœ¬ç€çº¯é™æ€çš„æ€æƒ³, é€‰æ‹©äº†utterances, åŸºäºGitHub issues. ç¼ºç‚¹æ˜¯éœ€è¦ç™»å½•GitHubæˆæƒ, ä»¥åŠå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘\næŒç»­æŠ˜è…¾ä¸­\u0026hellip; æœ€å, å¸Œæœ›è‡ªå·±å’ŒhxdåŒå­¦èƒ½åšæŒå†™è¿™ä¸ªåšå®¢, ç§¯å°‘æˆå¤š, åŠ æ²¹ğŸ’ª\n","description":"","id":15,"section":"posts","tags":["åšå®¢"],"title":"åšå®¢æŠ˜è…¾è®°(æŒç»­æ›´æ–°)","uri":"https://blog.syzh.fun/posts/syzh/blog-system-change-updating/"},{"content":"éšç€å…¬å¸çš„å‘å±•å’Œé¡¹ç›®çš„è¿­ä»£ï¼Œå¾ˆå¤šå›¢é˜Ÿéƒ½ç»´æŠ¤è€…ä¸€ä¸ªè¶Šæ¥è¶Šåºå¤§çš„å‰ç«¯é¡¹ç›®ç¾¤ï¼Œå…¶ä¸­å¯èƒ½æœ‰jqueryé¡¹ç›®ï¼Œvueé¡¹ç›®ï¼Œreacté¡¹ç›®ï¼Œå¦‚ä½•æ›´å¥½çš„åˆ†å‰²å’Œæ•´åˆé¡¹ç›®ï¼Œæˆä¸ºå¾ˆå¤šå·¥ç¨‹å¸ˆçš„éœ€æ±‚ã€‚å‚è€ƒåç«¯å¾®æœåŠ¡çš„æ¦‚å¿µï¼Œå‰ç«¯æå‡ºäº†å¾®å‰ç«¯çš„æ–¹æ¡ˆã€‚\nsingle-spaæ˜¯å…¶ä¸­æ¯”è¾ƒæœ‰äººæ°”çš„ï¼Œæœ¬æ–‡ä¹Ÿæ˜¯åœ¨åŸºäºå­¦ä¹ è¿™é‡Œçš„å†…å®¹ç»™å‡ºçš„æ€»ç»“ã€‚åŒæ—¶ä¹Ÿç ”ç©¶äº†\nè¿™é‡Œ çš„ä»£ç \nå¾®å‰ç«¯çš„ä¼˜åŠ¿ï¼š\n åœ¨åŒä¸€é¡µé¢ä¸Šä½¿ç”¨å¤šä¸ªå‰ç«¯æ¡†æ¶ è€Œä¸ç”¨åˆ·æ–°é¡µé¢ (React, AngularJS, Angular, Ember, ä½ æ­£åœ¨ä½¿ç”¨çš„æ¡†æ¶) ç‹¬ç«‹éƒ¨ç½²æ¯ä¸€ä¸ªå•é¡µé¢åº”ç”¨ æ–°åŠŸèƒ½ä½¿ç”¨æ–°æ¡†æ¶ï¼Œæ—§çš„å•é¡µåº”ç”¨ä¸ç”¨é‡å†™å¯ä»¥å…±å­˜ æ”¹å–„åˆå§‹åŠ è½½æ—¶é—´ï¼Œå»¶è¿ŸåŠ è½½ä»£ç   åœ¨æˆ‘ç†è§£æ¥çœ‹ï¼Œå¾®å‰ç«¯ä¸»è¦æ»¡è¶³ç”¨ä¸€ä¸ªæ›´å¥½çš„è°ƒåº¦æ¡†æ¶ï¼Œæ¥è°ƒåº¦å„ä¸ªä¸åŒé¡¹ç›®åœ¨é¡µé¢çš„å±•ç¤ºçš„éœ€æ±‚ã€‚\nä¾‹å¦‚ /#reactApp å°±åŠ è½½reacté¡¹ç›®ï¼Œ\n/#vueApp å°±åŠ è½½vueé¡¹ç›®ï¼Œè·¯ç”±åˆ‡æ¢å¯ä»¥å¸è½½å½“å‰é¡¹ç›®ï¼Œåˆ‡æ¢æ–°é¡¹ç›®ã€‚è¯´åˆ°åº•æ¯ä¸ªé¡¹ç›®å°±æ˜¯ä¸€ä¸ªé€šè¿‡æ‰“åŒ…ä¹‹åçš„bundle.js,ä¹Ÿå°±æ˜¯è¯´è·¯ç”±åˆ‡æ¢å¯ä»¥åŠ è½½ä¸åŒçš„jsè¿›æ¥ï¼Œæ¯ä¸ªjséƒ½ç»´æŠ¤ä¸€ä¸ªå•é¡µåº”ç”¨ã€‚\nåœ¨single-spa ä¸­ï¼Œæ¯ä¸€ä¸ªé¡¹ç›®éƒ½æ˜¯ä¸€ä¸ªapplication,ä»¥ä¸‹ç®€ç§°app,ä¸ºäº†single-spaå¯ä»¥å¾ˆå¥½çš„è°ƒåº¦å„é¡¹ç›®çš„åŠ è½½ï¼Œå¸è½½æµç¨‹ï¼Œé¦–å…ˆæ¯ä¸ªé¡¹ç›®éœ€è¦åŒ…è£…ç»Ÿä¸€æ¥å£ï¼Œ\n1 2 3 4 5  const app1 = { bootstrap: () =\u0026gt; Promise.resolve(), //bootstrap function  mount: () =\u0026gt; Promise.resolve(), //mount function  unmount: () =\u0026gt; Promise.resolve(), //unmount function }   æ¯ä¸ªé¡¹ç›®éƒ½æœ‰ bootstrapï¼Œmount,unmout å›è°ƒï¼Œå…¶ä¸­å›è°ƒè¿”å›promise,ä¹Ÿå¯ä»¥åŒ…å«ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€é¡¹éƒ½æ˜¯è¿”å›promiseçš„å‡½æ•°ã€‚promise æ”¯æŒåé¢å¼ºå¤§çš„é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥è®©single-spaå°†app åƒç®¡é“ä¸€æ ·ç­›é€‰ï¼ŒåŠ è½½ï¼Œå¸è½½ã€‚appå›è°ƒå‡½æ•°ä¼šåœ¨single-spaåˆé€‚çš„è°ƒåº¦æ—¶æœºè¢«è°ƒç”¨ã€‚\nå…¶ä¸­ä¾‹å¦‚mount å›è°ƒä¸­ï¼Œä¸åŒçš„appå¯ä»¥åˆ†åˆ«æ‰§è¡Œè‡ªå·±çš„æ¸²æŸ“,single-spaä¼šä¼ å…¥å‚æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åŒçš„appéƒ½éœ€è¦è°ƒæ•´è‡ªå·±çš„å…¥å£æ–‡ä»¶ï¼Œæ»¡è¶³appçš„å›è°ƒæ‰èƒ½åµŒå…¥è¿™ä¸ªæ›´åŠ çµæ´»çš„æ•´ä½“\n1 2 3 4 5 6 7 8 9 10  export function mount(props) { return Promise .resolve() .then(() =\u0026gt; { // Do framework UI rendering here  // è¿™é‡Œå¯ä»¥åˆ†åˆ«è°ƒç”¨react/vue çš„æ¸²æŸ“  console.log(\u0026#39;mounted!\u0026#39;) }); }   ä¸ºäº†æ›´åŠ æ–¹ä¾¿å¾—æ§åˆ¶app,åˆ†ç±»app,æ‰‹å†™å¾®å‰ç«¯æ¡†æ¶ æå‡ºäº†appçš„11ä¸ªçŠ¶æ€ï¼Œæ¯ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªapp åœ¨åŠ è½½/å¯åŠ¨/æŒ‚è½½/å¸è½½ è¿‡ç¨‹ä¸­çš„æŸä¸ªé˜¶æ®µï¼Œä»»ä½•ä¸€ä¸ªé˜¶æ®µå‡ºé”™äº†ï¼ŒçŠ¶æ€éƒ½æˆä¸ºå‡ºé”™çŠ¶æ€ï¼Œä¸å¯é€†ã€‚\nä¸ºäº†ç¡®ä¿single-spa å¤„ç†è·¯ç”±åœ¨ä»»ä½•appä¹‹å‰ï¼Œé‡‡ç”¨æ‹¦æˆªwindow.addEventlistener çš„æ–¹æ³•ï¼Œåœ¨æ‹¦æˆªçš„æ–¹æ³•é‡Œå°†hashchange|popstate è¿™è¿ä¸ªäº‹ä»¶å­˜å‚¨èµ·æ¥ï¼Œå…ˆä¸æ‰§è¡Œï¼Œé»˜è®¤åªæ‰§è¡Œsingle-spaæ·»åŠ çš„hashchange|popstateï¼Œç­‰åˆ°single-spa æ§åˆ¶æµç¨‹ç»“æŸï¼Œå†ä¾æ¬¡è§¦å‘ï¼ˆæ­¤æ—¶å°±æ˜¯react-routerã€vue-routerç­‰ç»‘å®šçš„äº‹ä»¶ï¼‰\næ•´ä¸ªæµç¨‹çš„æ ¸å¿ƒåœ¨äºsingle-spa çš„æ ¸å¿ƒæµç¨‹ï¼Œé»˜è®¤é¦–å…ˆåŠ è½½è¢«æ³¨å†Œçš„appï¼Œç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦æŒ‚è½½/å¸è½½app,å¦‚æœæµè§ˆå™¨æˆ–è€…æ‰‹åŠ¨è§¦å‘äº†éœ€è¦æ›´æ”¹app,å†ä¾æ¬¡æ‰§è¡Œå¸è½½ä¸éœ€è¦çš„ï¼ŒæŒ‚è½½éœ€è¦çš„appæµç¨‹ã€‚æ­¤æµç¨‹æ ¸å¿ƒä»£ç ä½äº/my-single-spa/src/navigation/invoke.js\n","description":"","id":16,"section":"posts","tags":["å‰ç«¯"],"title":"å¾®å‰ç«¯å­¦ä¹ æ€»ç»“","uri":"https://blog.syzh.fun/posts/hxd/micro-front-end/"},{"content":"mac app   å¿«æ·å¯åŠ¨: alfred\n alfredåŸºæœ¬ç®—æ˜¯macå¿…å¤‡appäº†, ä¸»è¦ç”¨åˆ°çš„åŠŸèƒ½å¦‚ä¸‹  å¿«æ·å¯åŠ¨ æ–‡ä»¶æœç´¢ snippetsçŸ­è¯­æ‰©å±• è®¡ç®—å™¨ å­—å…¸ å¯†ç ç®¡ç†1password   workflows  é¢œè‰²è‰²å€¼ç›¸å…³è½¬æ¢: Colors v2.0.2 æ—¶é—´æ ¼å¼ç›¸å…³è½¬æ¢: Datetime Format Converter ç¼–è§£ç : Encode / Decode v1.8.0 å¿«æ·æ‰“å¼€é¡¹ç›®: JetBrains - Open project å‘½ä»¤ç”¨æ³•é€ŸæŸ¥: tldr uuidç”Ÿæˆå™¨: uuid generator      æ•°æ®åº“è¿æ¥: sequel pro\n è™½ç„¶å·²ç»åŸºæœ¬åœæ­¢å¼€å‘äº†, ä¹Ÿå°è¯•è¿‡å…¶ä»–è¯¸å¦‚datagrip, ä¸è¿‡ä¸ä¹ æƒ¯, åˆæ¢å›æ¥äº†    å¤‡ä»½: macè‡ªå¸¦çš„time machine\n  gifå½•å±: licecap\n  pdfé˜…è¯»å™¨: skim/pdfelement, åè€…å¤‡ç”¨\n  ä»»åŠ¡ç®¡ç†: omniFocus\n  è§†é¢‘æ’­æ”¾å™¨: iina\n  é”®ç›˜è‡ªå®šä¹‰æ˜ å°„: karabiner\n æŠŠé•¿æŒ‰enteræ˜ å°„ä¸ºctrl, ç‚¹å‡»capslockæ˜ å°„ä¸ºesc, é•¿æŒ‰capslockæ˜ å°„ä¸ºctrlç­‰ç­‰ æ›´å¤šå¤æ‚æ˜ å°„, æ¯”å¦‚emacsä¸“ç”¨æ˜ å°„ç­‰ç­‰, å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°    ç³»ç»ŸæŒ‡æ ‡ç›‘è§†å™¨: istat menus\n åœ¨èœå•æ æ˜¾ç¤ºä¸Šä¸‹è¡Œæµé‡, cpuæ¸©åº¦, cpuä½¿ç”¨ç‡ç­‰ç­‰    ç»ˆç«¯: iterm\n  å¯†ç ç®¡ç†: 1password\n  æ¸…ç†é”®ç›˜è¾…åŠ©å·¥å…·: KeyboardCleanTool\n  æ–‡æœ¬ç¼–è¾‘å™¨: sublime/vscode\n  å·¥ä½œä¼‘æ¯æé†’: stretchly\n  æµè§ˆå›¾ç‰‡: xnviewMP\n  æ–‡ä»¶åŒæ­¥: dropbox\n  æŠ“åŒ…: charles\n  èœå•æ å›¾æ ‡ç®¡ç†: bartender\n  è‡ªåŠ¨åˆ‡æ¢å£çº¸: irvue\n  æ€ç»´å¯¼å›¾: scapple\n  å¬æ­Œ: spotify + telegram\n telegramçš„vk music botæœºå™¨äººå¯ä»¥æœç´¢å¹¶ä¸‹è½½å„ç§æ­Œæ›², è€Œä¸”è‡ªå¸¦çš„éŸ³ä¹æ’­æ”¾åŠŸèƒ½è¿˜ä¸é”™\u0026hellip;    markdownç¼–è¾‘å™¨: typora + ipic\n typoraå¯ä»¥æ”¯æŒå¾ˆå¤š$\\LaTeX$å…¬å¼ç¬¦å·ç­‰ç­‰ ipicå¯ä»¥å¸®åŠ©typoraè‡ªåŠ¨ä¸Šä¼ å›¾ç‰‡    å‘½ä»¤è¡Œå·¥å…·  åŒ…ç®¡ç†å™¨: homebrew httpå®¢æˆ·ç«¯: httpie git diffå¢å¼º: diff-so-fancy æ–‡ä»¶æŸ¥æ‰¾(æ›¿ä»£find): fd shell: fish å‘½ä»¤å†å²æŸ¥æ‰¾: fzf æ–‡ä»¶å†…å®¹æœç´¢(æ›¿ä»£grep): ripgrep  å„ç§ide/ç¼–è¾‘å™¨é…è‰²æ–¹æ¡ˆ: dracula åœ¨çº¿latexç¼–è¾‘å™¨: overleaf ","description":"","id":17,"section":"posts","tags":["MacOS"],"title":"è®°å½•ä¸€ä¸‹macé‡Œè£…çš„åº”ç”¨","uri":"https://blog.syzh.fun/posts/syzh/my-mac-app/"},{"content":"å°ç«™çš„è¯„è®ºç³»ç»Ÿä½¿ç”¨äº†utterances, åŸºäºGitHub issues, å› æ­¤å¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘æ”¯æŒ\nä¸æ–¹ä¾¿çš„åŒå­¦, æ¬¢è¿é€šè¿‡æ¯ç¯‡åšæ–‡åº•éƒ¨çš„ä½œè€…é‚®ç®±æˆ–Githubè´¦å·ä¸æˆ‘ä»¬è”ç³»\n","description":"Hugo, the worldâ€™s fastest framework for building websites","id":22,"section":"","tags":null,"title":"About","uri":"https://blog.syzh.fun/about/"}]